
import BCUfunctions 
from Numeric import *

oko0 = [92,70,78,100,116,111,93,69,64,76,92,105,112,113,122,115,109,100,77,86,73,73,86,87,96,103,106,109,108,116,116,106,102,105,100,90,          88]
oko1 = [111,100,118,126,114,107,98,98,111,116,130,134,127,112,109,110,101,93,88,103,109,114,114,122,132,125,127,121,114,113,111,110,108,102,102,98,          98]

oko2 = [62,63,92,77,81,85,69,85,105,137,106,97,82,91,100,107,96,95,73,97,106,124,123,114,100,100,93,93,96,103,106,107,102,104,100,95,          91]


#	oko2 = [42, 40, 123, 103, 103, 77, 116, 101, 93, 95, 93, 100, 91, 78, 100, 102, 99, 101, 108, 105, 96, 99, 106, 109, 99, 91, 110, 92, 91, 101, 101, 102, 104, 104, 95, 108, 100]

#	oko2 = [ 24, 100, 123, 108, 132, 127, 123, 88, 99, 95, 103, 102, 84, 96, 97, 113, 110, 99, 94, 100, 103, 105, 97, 98, 98, 101, 100, 98, 102, 96, 102, 100, 106, 107, 105, 100, 101]



oko3 = [128,108,119,104,127,135,111,89,123,116,94,76,84,104,131,117,107,94,85,96,111,116,105,95,81,83,75,86,100,110,116,105,102,99,91,88,          82]
oko4 = [106,102,116,109,89,110,126,72,84,112,132,104,86,76,85,104,128,124,100,81,74,90,100,115,120,100,87,82,80,81,91,100,106,114,107,101,          86]
oko5 = [101,79,110,151,136,85,60,102,101,99,123,100,107,96,88,84,86,106,87,101,99,95,94,90,87,84,79,87,92,97,85,88,88,101,104,106,         104]
oko6 = [93,129,141,108,59,75,87,97,107,95,116,107,81,111,109,99,90,81,93,89,81,82,79,92,96,97,92,103,113,122,110,99,96,89,87,85,          86]
oko7 = [105,107,79,111,90,108,75,131,92,71,112,104,84,74,121,135,95,85,100,109,114,88,97,111,126,100,88,76,83,94,113,118,117,98,97,100,         108]
oko8 = [94,105,99,88,123,98,100,108,72,125,114,89,86,117,133,84,81,103,133,101,76,87,114,130,112,96,88,93,110,119,108,98,89,90,103,121,         115]
oko9 = [79,71,102,110,77,130,140,118,85,94,132,127,97,96,115,92,97,98,97,120,113,109,100,89,72,100,97,93,100,107,101,89,79,88,91,99,         110]
oko10 = [88,126,53,132,104,71,122,100,89,105,104,104,115,102,98,97,104,86,114,86,94,127,115,103,91,91,91,87,101,107,103,103,104,102,86,65,          84]
oko11 = [106,91,74,83,116,83,127,119,138,97,113,109,84,96,94,70,94,110,76,102,103,78,80,102,118,101,88,100,98,124,117,109,94,120,109,98,          84]
oko12 = [125,102,95,104,104,94,94,74,94,102,74,146,69,82,103,96,70,112,113,89,115,100,111,91,91,122,116,76,94,110,101,97,88,85,110,101,          84]
oko13 = [127,104,90,96,100,115,98,98,76,96,98,95,79,113,82,76,101,60,64,104,107,91,110,128,110,101,104,103,98,98,68,85,86,93,83,81,         101]
oko14 = [111,90,89,114,105,110,105,129,102,138,98,105,78,91,65,133,86,91,103,93,72,78,103,93,83,91,116,125,109,91,120,95,101,100,87,100,         102]
oko15 = [74,108,102,109,93,121,108,102,104,102,67,122,118,129,80,114,77,122,87,110,101,85,111,113,124,80,66,95,96,100,97,100,99,79,99,102,          82]
oko16 = [92,118,121,111,108,77,122,105,75,105,77,83,112,69,106,94,85,104,59,127,91,98,103,113,86,122,107,99,85,95,120,114,102,100,90,114,         101]
oko17 = [123,63,104,131,77,90,102,114,89,116,63,102,88,120,103,83,122,103,109,100,100,120,65,117,109,106,87,96,102,100,110,113,112,100,101,100,         109]
oko18 = [100,112,103,101,91,135,78,98,82,96,93,101,110,62,74,68,104,93,113,103,105,107,107,105,98,92,79,118,120,128,131,101,103,116,116,98,          93]
oko19 = [147,82,92,90,72,88,111,79,100,92,118,89,131,103,88,112,63,94,100,97,94,105,108,108,87,89,81,103,94,112,101,124,100,93,105,115,         112]
oko20 = [96,88,117,89,129,72,119,77,83,86,102,113,78,100,86,111,99,74,115,118,117,113,97,84,123,93,71,126,102,85,117,95,107,96,85,104,         101]
oko21 = [109,98,93,102,90,94,94,89,111,117,94,123,109,88,138,80,109,98,110,119,101,73,110,106,89,71,98,140,61,88,96,94,117,99,96,90,          97]
oko22 = [122,111,91,91,94,99,86,112,93,88,107,110,84,109,111,104,92,136,84,134,63,137,110,89,101,105,86,118,112,86,96,85,100,114,111,82,          97]
oko23 = [100,90,105,106,104,85,101,98,113,83,96,106,87,100,93,111,132,99,112,134,96,75,129,122,70,106,92,94,135,104,79,134,98,100,107,100,          89]
oko24 = [98,90,99,103,100,104,99,93,93,105,111,69,102,99,94,116,77,110,128,132,116,98,66,121,97,117,111,108,92,110,90,85,101,102,100,79,          54]
oko25 = [94,76,134,84,117,100,106,121,110,74,83,112,109,81,103,103,82,93,114,73,76,111,104,129,99,98,100,100,87,101,90,100,93,111,98,58,         107]
oko26 = [94,97,96,130,87,90,113,95,103,74,97,76,76,99,113,107,91,126,92,69,130,97,122,124,99,93,103,135,115,97,108,78,94,107,109,106,         107]
oko27 = [82,112,78,116,100,120,100,67,132,100,92,106,92,83,111,101,85,81,102,104,77,113,67,117,100,116,87,115,110,84,86,111,75,106,94,118,         117]
oko28 = [102,96,100,95,101,103,100,108,88,113,109,93,108,84,113,79,84,113,98,83,115,90,95,86,110,101,93,110,136,55,92,140,94,74,98,74,          87]
oko29 = [101,118,98,81,109,95,93,116,83,114,106,122,108,109,99,118,110,105,93,74,124,94,82,114,64,135,59,118,93,100,89,96,102,111,104,104,         105]
oko30 = [103,112,103,88,103,91,98,100,87,100,102,120,104,108,100,110,103,94,93,104,111,109,74,129,86,50,124,88,109,74,120,103,71,115,127,106,          90]
oko31 = [90,105,97,96,113,114,93,95,107,76,118,104,81,118,82,78,96,112,99,93,92,116,92,124,73,100,113,105,84,89,119,117,142,62,93,106,          98]
oko32 = [98,103,106,100,96,109,96,98,90,98,100,108,92,117,100,90,78,114,108,99,112,99,104,95,96,90,109,96,102,99,89,126,112,162,48,111,         100]
oko33 = [91,103,105,112,97,109,99,108,95,96,101,88,86,129,96,96,99,83,110,97,98,102,118,82,100,117,100,119,56,90,109,138,66,113,133,99,          85]
oko34 = [113,97,95,93,98,95,81,102,108,91,103,99,113,98,95,100,127,121,109,99,99,102,107,111,104,110,97,103,89,95,131,96,48,84,47,106,          89]
oko35 = [96,113,100,101,105,100,98,79,96,111,103,97,89,101,85,110,104,130,99,115,114,94,88,100,103,91,107,104,89,124,102,122,86,94,101,55,         157]
oko36 = [99,104,100,100,106,96,101,117,86,99,98,103,91,80,102,112,112,109,93,90,97,126,89,95,109,73,109,128,93,139,59,125,92,80,93,126,          81]

oko_ort = [oko0,oko1,oko2,oko3,oko4,oko5,oko6,oko7,oko8,oko9,oko10,oko11,oko12,oko13,oko14,oko15,oko16,oko17,oko18,oko19,oko20,oko21,oko22,oko23,oko24,oko25,oko26,oko27,oko28,oko29,oko30,oko31,oko32,oko33,oko34,oko35,oko36]

def apply_zokos( zernlist):
	flat_pos = array(BCUfunctions.flatOKO())
	pos_100 = array([100] * 37)

	ort_array = array([0] * 37)
	for n in range(len(zernlist)):
		(z,intens) = zernlist[n]
		temp_oko = oko_ort[z]
		for n in range(37):
			temp_oko[n] = temp_oko[n]*intens
		ort_array = ort_array + array(temp_oko) - pos_100


	oko_pos = flat_pos + ort_array

	for n in range(37):
		if oko_pos[n]<20:
			print "cut oko_pos from "+str(oko_pos[n])+" to 20"
			oko_pos[n] =20

	print "setting oko to "+str(oko_pos)
	BCUfunctions.set_oko(oko_pos)


def apply_zoko(zernike, intensity):
	flat_pos = array(BCUfunctions.flatOKO())
	pos_100 = array( [100] * 37)

	ort_array = array(oko_ort[zernike])
	ort_array = (ort_array-100)* intensity 
	for n in range(37):
		ort_array[n] = ort_array[n] 

	oko_pos = [0] * 37
#	for n in range(37):
#		if ort_array[n] == 0:
#			oko_pos[n] = int(flat_pos[n])
#		else:
#			oko_pos[n] = int(sqrt( flat_pos[n]*flat_pos[n] + ort_array[n]*ort_array[n] * (ort_array[n]/(sqrt(ort_array[n]*ort_array[n]))))) 

	oko_pos = ort_array + flat_pos

	for n in range(37):
		if oko_pos[n]<20:
			print "cut oko_pos from "+str(oko_pos[n])+" to 20"
			oko_pos[n] =20

	print "setting oko to "+str(oko_pos)
	BCUfunctions.set_oko(oko_pos)

